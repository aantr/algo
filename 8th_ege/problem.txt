№ 666 (Уровень: Гроб)
(А. Антропов) Лошадь составляет слова из букв A, B, C, D, E. Каждый символ в последовательности может встречаться любое количество раз или не встречаться совсем. Слова должны удовлетворять следующим условиям:

1) не содержат двух одинаковых букв, стоящих рядом.
2) следующая буква после букв из набора A, B, C, D должна быть старше предыдущей (например, после буквы С следующей могут стоять только буквы D или Е).
3) на первом месте не могут стоять буквы А и Е.
4) не существует такой подстроки этого слова длины ровно 5, что подстрока является палиндромом (подстрокой называется непрерывная подпоследовательность символов слова).
Сколько различных 33-буквенных слов может составить лошадь? Гарантируется, что ответ меньше, чем 2 ^ 63.
